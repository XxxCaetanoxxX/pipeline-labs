name: Demo Github Secrets

on:
  push:
    branches:
      - main

jobs:
  demo-secrets:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: configurar credenciais da api
        env: 
          API_KEY: ${{ secrets.API_KEY }}
          API_URL: ${{ secrets.API_URL }}
        run: | 
          echo "configurando conexao com api externa..."
          echo "URL DA API: $API_URL"
          echo "API KEY está configurada ${API_KEY:+SIM}"

      - name: Conectar banco de dados
        env:
          DB_USER: ${{ secrets.DB_USER }}
          DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
          DB_HOST: ${{ secrets.DB_HOST }}
          DB_PORT: ${{ secrets.DB_PORT }}
        run: |
          echo "conectando ao banco de dados..."
          echo "USUARIO: $DB_USER"
          echo "SENHA está configurada ${DB_PASSWORD:+SIM}"
          echo "HOST: $DB_HOST"
          echo "PORTA: $DB_PORT"
    
      - name: preparar deploy tokens
        env:
          DEPLOY_TOKEN: ${{ secrets.DEPLOY_TOKEN }}
        run: |
          echo "preparando deploy com token seguro..."
          echo "token do deploy: $DEPLOY_TOKEN"
          echo "github automaticamente mascara o valor real do token"

      - name: verificar segurança dos secrets
        run: |
          echo "verificando se algum segredo foi exposto..."
          echo "secrets nunca aparecem em logs, sao substituidos por ***"
          echo "secrets não são acessiveis em forks do repositório"